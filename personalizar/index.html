<!DOCTYPE HTML>
<html lang="es-CL">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140369062-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-140369062-1');
// <!-- Google Tag Manager -->
    <!-- (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      }
    )
    (window,document,'script','dataLayer','GTM-M5LWCHD');
  </script> -->
  
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <title>Malla Interativa personalizada</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.css">    
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
  <script 
    defer
    src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"
    integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" 
    crossorigin="anonymous">
  </script>
  <link rel="stylesheet" href="/css/darkMode.css">
  <link rel="stylesheet" href="/css/styles.css">
  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#2f58a7">
  <meta name="apple-mobile-web-app-title" content="Mallla Interactiva">
  <meta name="application-name" content="Mallla Interactiva">
  <meta name="msapplication-TileColor" content="#2f58a7">
  <meta name="theme-color" content="#f8f9fa">
</head>
<body class="d-flex flex-column">
  <!-- En verdad, lamento la cantidad horrorosa de divs -->
  <!-- Google Tag Manager (noscript) -->
  <!-- <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M5LWCHD"
    height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript> -->
  <!-- End Google Tag Manager (noscript) -->




  <!-- Contact Modal -->
  <div class="modal fade bg-danger"
    id="contacto" 
    tabindex="-1" 
    role="dialog" 
    aria-labelledby="contacto" 
    aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header bg-light">
          <h5 class="modal-title" ><i class="fas fa-exclamation-triangle"></i> Antes de contactar</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          Si deseas <strong> agregar o cambiar </strong> una <strong> malla</strong>, primero te invito a mirar el codigo fuente. ¡Allí podras encontrar toda la informacion que necesitas! <br>
          Si encontraste un <strong> error/bug </strong> en la pagina puedes reportarlo desde el codigo fuente vía "Issues". De todas formas puedes contactarme.
        </div>
        <div class="modal-footer bg-light">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
          <a href="http://github.com/etra0/ramos" class="btn btn-primary"><i class="fas fa-code-branch"></i> Codigo fuente</a>
          <button type="button" id="contactar" onclick="contactar()" class="btn btn-danger"><i class="fas fa-envelope"></i> Contactar</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Contact Modal END -->

  <!-- Agregar ramo Avanzado -->
  <div class="modal fade"
    id="crearRamoAvanzado" 
    tabindex="-1" 
    role="dialog" 
    aria-labelledby="crearRamoAvanzado" 
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="titleRamoAvanzado">Añadir ramo: Advanced Edition</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body row">
          <div class="col-md">
            <div class="form-group">
              <label for="newRamo">Nombre asignatura</label>
                <input type="text" class="form-control" id="custom-namea" placeholder="Malla interactiva avanzada">
            </div>
            <div class="form-group">
              <label for="newRamo">Sigla asignatura</label>
              <input type="text" class="form-control" id="custom-siglaa" placeholder="INF-321">
              <small id="sigla-Help" class="form-text text-muted">
                Asegurate de que la sigla NO contenga espacios.
              </small>
            </div>
            <div class="form-group">
              <label for="newRamo">Creditos</label>
              <input type="number" class="form-control" id="custom-creditsa" placeholder="1">
            </div>
          </div>
          <div class="col-md">
            <div id='editorEnablerDiv' class="custom-control custom-switch d-none">
              <input type="checkbox" onchange="editorEnabler('advEditorEnabler')" class="custom-control-input" id="advEditorEnabler">
              <label class="custom-control-label" for="advEditorEnabler">Edición Avanzada</label>
            </div>
            <label for="grupoDeRamos">Categoría</label>
            <div class="input-group mb-3">
              <!-- <div class="input-group-prepend">
                <label class="input-group-text" for="gruposDeRamos">Grupo de Ramo</label>
              </div> -->
              <select class="custom-select" id="elegirSector">
                <option selected>Fuera de malla oficial</option>
              </select>
            </div>
            <div class="input-group mb-0">
              <select onchange="addTo('agregarPreRequisitos')" class="custom-select mb-0" id="agregarPreRequisitos"">
                <option value="0" selected>Elige los Pre-requisitos</option>
              </select>
            </div>
            <ul id="preRequisitos" class="disabled list-group pt-1 mb-3">
              <!-- <li class="list-group-item d-flex align-items-center pr-0 py-0">
                <div class="flex-grow-1 "> SIG-101 | Placeholder  </div> 
                <button class="btn btn-danger m-0 py-0 py-1 text-white" type="button" onclick=""> Quitar</button>
              </li> -->
            </ul>
            <div class="input-group mb-0 d-none">
              <select onchange="addTo('agregarConvalidaciones')" class="custom-select mb-0" id="agregarConvalidaciones" disabled="true">
                <option value="0" selected>Elige las convalidaciones</option>
              </select>
            </div>
            <ul id="convalidaciones" class="list-group pt-1 mb-3">
              <!-- <li class="list-group-item d-flex align-items-center pr-0 py-0">
                <div class="flex-grow-1 "> SIG-101 | Placeholder  </div> 
                <button class="btn btn-danger m-0 py-0 py-1 text-white" type="button" onclick=""> Quitar</button>
              </li> -->
            </ul>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
          <button type="button" id="advancedRamoButton" onclick="createRamoAdvanced()" class="btn btn-primary">Agregar</button>
        </div>
      </div>
    </div>
  </div>
<!-- fin ramo Avanzado -->

  <!-- Agregar ramo personalizado -->
  <div class="modal fade"
    id="crearRamoModal" 
    tabindex="-1" 
    role="dialog" 
    aria-labelledby="crearRamo" 
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="crearRamo">Añadir ramo fuera de la malla</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="newRamo">Nombre asignatura</label>
              <input type="text"
                class="form-control" 
                id="custom-name" 
                placeholder="Introducción a la malla interactiva">
          </div>
          <div class="form-group">
            <label for="newRamo">Sigla asignatura</label>
            <input type="text" class="form-control" id="custom-sigla" placeholder="INF-123">
            <small id="sigla-Help" class="form-text text-muted">
              Asegurate de que la sigla NO contenga espacios.
            </small>
          </div>
          <div class="form-group">
            <label for="newRamo">Creditos</label>
            <input type="number" class="form-control" id="custom-credits" placeholder="1">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
          <button type="button" id="crearRamo" onclick="crearRamo(true)" class="btn btn-primary">Agregar</button>
        </div>
      </div>
    </div>
  </div>
<!-- fin ramo personalizado -->

<!-- Sector Modal -->
<div class="modal fade"
id="crearSectorModal" 
tabindex="-1" 
role="dialog" 
aria-labelledby="crearSector" 
aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="sectorTitle" id="crearSector">Añadir grupo de ramos</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="newRamo">Nombre grupo</label>
          <input type="text"
            class="form-control" 
            id="sectorName" 
            placeholder="Ingeniería de mallas interactivas">
      </div>
      <div class="form-group">
        <label for="newRamo">Abreviatura del grupo</label>
        <input type="text" class="form-control" id="smallSectorName" placeholder="IMI">
        <small class="form-text text-muted">
          Tiene que ser unico y sin espacios. Nunca lo veras en la malla, pero para la página es útil
        </small>
      </div>
      <div class="form-group">
        <label for="newRamo">Color del grupo</label>
        <input type="text" class="form-control" id="sectorColor" placeholder="#ffffff">
        <small class="form-text text-muted">
          Busca en google "color picker", elige el color y copia y pega el HEX
        </small>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" id="sectorCancelButton" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
      <button type="button" id="sectorDoneButton" onclick="finishedCreatingSector()" class="btn btn-primary">Agregar</button>
    </div>
  </div>
</div>
</div>
<!-- Sector Modal END -->

  <!-- Header -->
  <nav class="navbar navbar-light navbar-expand-md bg-light">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mallaNavbar" aria-controls="mallaNavbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a id='goToHome' class="navbar-brand mb-0 " href="/">Malla Interactiva <span class="carrera"></span></a>
        
    <div class="collapse navbar-nav mr-auto navbar-collapse navbar-expand-md " id="mallaNavbar">
      <a id='goToCalculator' class="nav-link" href="/prioridad/">Calculadora Prioridad</a>
      <a id='goToGenerator' class="nav-link active" href="#">Generadora Malla</a>
      <a class="d-none d-md-block nav-link dropdown-toggle" data-toggle="collapse" href="#" data-target="#carreras" aria-controls="carreras" aria-expanded="false" aria-label="Toggle navigation">
        Carreras
      </a>
      <div class="nav-item dropdown">
        <a class="nav-link dropdown-toggle d-md-none" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Carreras
        </a>
        <div class="dropdown-menu" id="carreras2-nav" aria-labelledby="navbarDropdown">
        </div>
      </div>
      <div class="nav-link" data-toggle="modal" data-target="#contacto"><i class="far fa-envelope"></i> Contacto</div>
    </div>
  </nav>
  <nav class="navbar py-0 navbar-light navbar-expand-md bg-light d-none d-md-block">
    <div class="collapse" id="carreras">
      <ul id="carreras1-nav" class="navbar navbar-nav">
      </ul>
    </div>
  </nav>
  <!-- Header END -->
    



  <!-- Main -->
  <section class="container-fluid flex-grow-1">
    <div class="row justify-content-center">
      <!-- Inicio canvas -->
      <div class="col-xl-7 ">
        <div class='custom-canvas' style="text-align:center;overflow-x:auto"></div>		          
        <div class='color-description'
          style="position:relative;display:flex;justify-content:center;flex-wrap:wrap;">
        </div>
      </div>
      <!-- Fin canvas -->
      <div class="col-sm-auto">
      <!-- Inicio calculadora -->
        <form id="priorix" class="card mt-5">
          <h4 class="card-header text-center">Generadora de mallas</h4>
          <div class="container my-0 py-2">
            <div class="row justify-content-center">
              <div class="col-12 justify-content-center text-center">
                <div class="badge badge-info text-left">
                  Ramos para el semestre Nº <span id="semestre"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body" style="overflow-y:auto">
            <ul class="list-group" id="ramos">
              <!-- Aqui van los ramos seleccionados -->
            </ul>
          </div>
          <p class="container card-text mb-0 text-center">
            <small class=" text-muted">
              ¿El ramo que quieres no esta en la malla? ¡Crealo en la <a data-scroll href="#anchor">tabla de abajo</a>!
            </small>
          </p>
          <div class="card-footer  px-3">
            <!-- Inicio Botones -->
            <div class="row no-gutters align-items-center justify-content-center">
              <div class="col-2 text-left">
                <button id="back" onclick="semestreAnterior()" type="button" class="btn btn-card btn-secondary">
                  <i class="fas fa-arrow-left"></i>
                </button>
              </div>
              <div class="col-8">
                <div class="container">
                  <div class="row justify-content-center">
                    <div class="btn-group" role="group">
                      <button type="button" id="generar" onclick="generate()" class="btn btn-card btn-info">
                        Generar
                      </button>
                      <button type="reset" onclick="limpiarSemestre()" class="btn btn-card btn-danger">
                        Limpiar Semestre
                      </button>
                    </div>
                  </div>
                  <div class="row justify-content-center">
                    <button id="reset" onclick="limpiarCalculadora()" type="button" class="btn btn-danger mt-1">
                      Restablecer malla
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-2 text-right">
                <button id="forward" onclick="proximoSemestre()" type="button" class="btn btn-secondary">
                  <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </div>
            <!-- Fin botones -->
          </div>
        </div>
      </form>
      <!-- Fin calculadora -->
    </div>
    <div id="anchor" class="row justify-content-center mt-5">
      <!-- Inicio Tabla fuera de malla -->
      <div class="col-lg-auto">
        <div class="card">
          <div  class="card-header">
            <h3 class="card-title">Ramos fuera de la malla / editados</h3>
          </div>
          <div class="table-responsive">
            <table id="customTable" class="card-body mb-0 table table-hover">
              <thead>
                <tr>
                  <th scope="col">Sigla</th>
                  <th scope="col">Nombre</th>
                  <th scope="col">Creditos</th>
                  <th scope="col">Estado</th>
                  <th scope="col">Pre-requisitos</th>
                  <th scope="col">Acciones</th>
                </tr>
              </thead>
              <tbody id="customTableContent">
                <!-- Aqui van los ramos fuera de malla -->
              </tbody>
            </table>
          </div>
          <div class="card-footer">
            <button 
              type="button" 
              data-toggle="modal" 
              data-target="#crearRamoModal"  
              class="btn btn-primary btn-sm">
              Crear ramo
            </button>
            <button 
              type="button" 
              data-toggle="modal" 
              data-target="#crearRamoAvanzado"
              onclick="fillSelections()"  
              class="btn btn-warning btn-sm">
              Crear ramo avanzado
            </button>
          </div>
        </div>
      </div>
      <!-- Fin Tabla -->
      <!-- categorías -->
      <div class="col-lg-auto">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">
              Categorías
            </h3>
          </div>
          <div class="card-body">
            <div id="sectors" class="list-group">
              <button type="button" data-toggle="modal" data-target="#crearSectorModal" class="list-group-item list-group-item-action">¡Agrega una categoría!</button>
              <!-- Aqui van los sectores -->
            </div>
          </div>
          <div class="card-footer py-1">

            <div class="small text-muted">Has click en una de las categorías para editarla</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main END -->
  <!-- Footer -->
  <footer  class="container-fluid text-center mt-3">        
    <div class="row bg-light align-items-end">
      <p class="col my-1 text-muted">Creado con el <i class="fas fa-heart"></i>️ por estudiantes para estudiantes <br/> <i class="fas fa-code-branch"></i> <a href="http://github.com/etra0/ramos">Código fuente</a></p>
    </div>
  </footer>
  <!-- Footer END -->

  <script src='../js/d3.js'></script>
  <script src='../js/ramos.js'></script>
  <script src='../js/selectableRamo.js'></script>
  <script src='../js/customRamo.js'></script>
  <script src="../js/generator.js"></script>
  <script src='../js/canvas.js'></script>
  <script src="/js/init.js"></script>
  <!-- Smooth scroll --> 
  <script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
  <script type="text/template" data-template="tab-template1">
    <li>
      <a class="nav-item nav-link" href="?m=${Link}"><span class="d-md-none">Malla </span>${Nombre}</a>
    </li>
  </script>
  <script type="text/template" data-template="tab-template2">
    <a class="dropdown-item" href="?m=${Link}">Malla ${Nombre}</a>
  </script>
  <script>
    scroll = new SmoothScroll('a[href*="#"]', {
      speed: 500,
      easing: 'easeInOutCubic'
    });
    var mediaQueryList = window.matchMedia("(max-width: 575.98px)");
    if (mediaQueryList.matches) {
      d3.select('.btn-group')
        .classed('btn-group-sm', true)
      // .classed('btn-group-vertical', true)
    }
      d3.select('#resetc').classed('btn-sm', true)
      // .classed('btn-group', false);
    function handleOrientationChange(mql) {
        d3.select('.btn-group')
          .classed('btn-group-sm', true)
      if (mql.matches) {
        // .classed('btn-group-vertical', true)
        // .classed('btn-group', false);
        d3.select('#resetc').classed('btn-sm', true)
      } else {
        d3.select('.btn-group')
          .classed('btn-group-sm', false)
        // .classed('btn-group-vertical', false)
        // .classed('btn-group', true);
        d3.select('#resetc').classed('btn-sm', false)
      }
    }
    handleOrientationChange(mediaQueryList);
    mediaQueryList.addListener(handleOrientationChange)
  </script>
</body>
</html>
